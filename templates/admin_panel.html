{% extends "base.html" %}
{% block content %}

<div class="hero-box fade-up">
  <div class="hero-inner">
    <div>
      <h1>Admin Panel</h1>
      <p class="subtitle">Manage doctors and monitor all scheduled appointments.</p>
    </div>
  </div>
</div>

<div class="grid" style="margin-top:16px;">
  <div class="col-12 card card-pad fade-up">
    <h2>Doctors</h2>

    <form method="POST" action="/admin/doctor/create" class="form" style="margin-bottom:14px;">
      <div class="grid" style="margin-top:0;">
        <div class="col-6 field ">
          <div class="label">Name</div>
          <input class="input" name="name" required style="padding-left:12px;">
        </div>
        <div class="col-6 field">
          <div class="label">Branch</div>
          <input class="input" name="branch" required style="padding-left:12px;">
        </div>
        <div class="col-6 field">
          <div class="label">Experience</div>
          <input class="input" name="experience" value="" style="padding-left:12px;">
        </div>
        <div class="col-6 field">
          <div class="label">Address</div>
          <input class="input" name="address" required style="padding-left:12px;">
        </div>
        <div class="col-6 field">
          <div class="label">Doctor Login Email</div>
          <input class="input" name="email" required style="padding-left:12px;">
        </div>
        <div class="col-6 field">
          <div class="label">Doctor Login Password</div>
          <input class="input" name="password" required style="padding-left:12px;">
        </div>
      </div>
      <button class="btn btn-primary" type="submit">Create Doctor</button>
    </form>

    <table class="table">
      <thead>
        <tr>
          <th>ID</th><th>Name</th><th>Branch</th><th>Status</th><th>Login Email</th><th>Update</th>
        </tr>
      </thead>
      <tbody>
        {% for d in doctors %}
        <tr>
          <td>#{{ d.id }}</td>
          <td>{{ d.name }}</td>
          <td>{{ d.branch }}</td>
          <td>{{ d.status }}</td>
          <td>{{ d.email or "-" }}</td>
          <td>
            <form method="POST" action="/admin/doctor/status/{{ d.id }}" style="display:flex;gap:8px;">
              <select class="input" name="status">
                <option value="AVAILABLE" {% if d.status=="AVAILABLE" %}selected{% endif %}>AVAILABLE</option>
                <option value="BUSY" {% if d.status=="BUSY" %}selected{% endif %}>BUSY</option>
                <option value="OFFLINE" {% if d.status=="OFFLINE" %}selected{% endif %}>OFFLINE</option>
              </select>
              <button class="btn btn-primary" type="submit">Save</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <p class="small" style="margin-top:10px;">
      Demo Admin login: <b>admin@clinicflow.local</b> / <b>admin1234</b>
    </p>
  </div>

  <div class="col-12 card card-pad fade-up">
    <h2>Recent Appointments</h2>

    <table class="table">
      <thead>
        <tr>
          <th>ID</th><th>Patient</th><th>Doctor</th><th>Date</th><th>Time</th><th>Status</th><th>Action</th>
        </tr>
      </thead>
      <tbody>
      {% for a in appointments %}
        <tr>
          <td>#{{ a.id }}</td>
          <td>{{ a.patient_email }}</td>
          <td>{{ a.doctor_name }} ({{ a.branch }})</td>
          <td>{{ a.appt_date or "-" }}</td>
          <td>{{ a.appt_time or "-" }}</td>
          <td>{{ a.status }}</td>
          <td>
            {% if a.status in ["WAITING","ACCEPTED"] %}
              <a class="btn btn-danger" href="/admin/appointment/cancel/{{ a.id }}">Cancel</a>
            {% else %}
              <span class="small">â€”</span>
            {% endif %}
          </td>
        </tr>
      {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
